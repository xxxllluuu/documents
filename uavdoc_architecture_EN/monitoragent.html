
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Monitor Agent Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="monitoragent.html" />
    
    
    <link rel="prev" href="healthmanager/jie-kou-shuo-ming.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    UAV.Monitor+APM  Architecture
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="healthmanager.html">
            
                <a href="healthmanager.html">
            
                    
                    Health Manager
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="healthmanager.html">
            
                <a href="healthmanager.html">
            
                    
                    HM Architecture
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="healthmanager/hmfu-wu.html">
            
                <a href="healthmanager/hmfu-wu.html">
            
                    
                    HM Servers
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.2.1" data-path="healthmanager/xin-tiao-shu-ju-fu-wu.html">
            
                <a href="healthmanager/xin-tiao-shu-ju-fu-wu.html">
            
                    
                    Heartbeat Data Server
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.2" data-path="healthmanager/hua-xiang-shu-ju-fu-wu.html">
            
                <a href="healthmanager/hua-xiang-shu-ju-fu-wu.html">
            
                    
                    Profile Data Server
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.3" data-path="healthmanager/shi-shi-shu-ju-fu-wu.html">
            
                <a href="healthmanager/shi-shi-shu-ju-fu-wu.html">
            
                    
                    Monitoring Data Server
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.4" data-path="healthmanager/rong-qi-jie-dian-shu-ju-fu-wu.html">
            
                <a href="healthmanager/rong-qi-jie-dian-shu-ju-fu-wu.html">
            
                    
                    Node Data Server
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.5" data-path="healthmanager/shi-shi-yu-jing-fu-wu.html">
            
                <a href="healthmanager/shi-shi-yu-jing-fu-wu.html">
            
                    
                    Runtime Notification Server
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.2.5.1" data-path="healthmanager/shi-shi-yu-jing-fu-wu/yu-jing-xin-xi-shu-ju-jie-gou-slice.html">
            
                <a href="healthmanager/shi-shi-yu-jing-fu-wu/yu-jing-xin-xi-shu-ju-jie-gou-slice.html">
            
                    
                    Notification Data Structure
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.5.2" data-path="healthmanager/shi-shi-yu-jing-fu-wu/yu-jing-ce-lve.html">
            
                <a href="healthmanager/shi-shi-yu-jing-fu-wu/yu-jing-ce-lve.html">
            
                    
                    Notification Strategy
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.5.3" data-path="healthmanager/shi-shi-yu-jing-fu-wu/yu-jing-ce-lve-biao-da-shi.html">
            
                <a href="healthmanager/shi-shi-yu-jing-fu-wu/yu-jing-ce-lve-biao-da-shi.html">
            
                    
                    Notification Strategy Expressions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.5.4" data-path="healthmanager/shi-shi-yu-jing-fu-wu/yu-jing-tong-zhi-ge-shi.html">
            
                <a href="healthmanager/shi-shi-yu-jing-fu-wu/yu-jing-tong-zhi-ge-shi.html">
            
                    
                    Notification Format
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.2.6" data-path="healthmanager/yu-jing-zhong-xin-fu-wu.html">
            
                <a href="healthmanager/yu-jing-zhong-xin-fu-wu.html">
            
                    
                    Notification Server
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.7" data-path="healthmanager/apphubfu-wu.html">
            
                <a href="healthmanager/apphubfu-wu.html">
            
                    
                    AppHub Manager
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.8" data-path="healthmanager/ri-zhi-fu-wu.html">
            
                <a href="healthmanager/ri-zhi-fu-wu.html">
            
                    
                    Log Data Server
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.9" data-path="healthmanager/diao-yong-lian.html">
            
                <a href="healthmanager/diao-yong-lian.html">
            
                    
                    APM Server
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.10" data-path="healthmanager/jie-kou-shuo-ming.html">
            
                <a href="healthmanager/jie-kou-shuo-ming.html">
            
                    
                    HM Interface
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter active" data-level="1.3" data-path="monitoragent.html">
            
                <a href="monitoragent.html">
            
                    
                    Monitor Agent
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.3.1" data-path="monitoragent.html">
            
                <a href="monitoragent.html">
            
                    
                    MA Architecture
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="monitoragent/xin-tiao-ji-zhi.html">
            
                <a href="monitoragent/xin-tiao-ji-zhi.html">
            
                    
                    Heartbeat Mechanism
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="monitoragent/ying-yong-shu-ju-cai-ji.html">
            
                <a href="monitoragent/ying-yong-shu-ju-cai-ji.html">
            
                    
                    Application Data Collection
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.3.1" data-path="monitoragent/ying-yong-shu-ju-cai-ji/ying-yong-shi-shi-shu-ju.html">
            
                <a href="monitoragent/ying-yong-shu-ju-cai-ji/ying-yong-shi-shi-shu-ju.html">
            
                    
                    Application Monitoring Data
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.2" data-path="monitoragent/ying-yong-shu-ju-cai-ji/ying-yong-hua-xiang-shu-ju.html">
            
                <a href="monitoragent/ying-yong-shu-ju-cai-ji/ying-yong-hua-xiang-shu-ju.html">
            
                    
                    Application Profile Data
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="monitoragent/rong-qi-ji-jin-cheng-shu-ju-cai-ji.html">
            
                <a href="monitoragent/rong-qi-ji-jin-cheng-shu-ju-cai-ji.html">
            
                    
                    Node and Process Data Collection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="monitoragent/shu-ju-gui-ji-ji-zhi.html">
            
                <a href="monitoragent/shu-ju-gui-ji-ji-zhi.html">
            
                    
                    File Data Collection Mechanism
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="monitoragent/jin-cheng-zhi-shou.html">
            
                <a href="monitoragent/jin-cheng-zhi-shou.html">
            
                    
                    Process Keep-alive
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.7" data-path="monitoragent/jie-dian-kong-zhi.html">
            
                <a href="monitoragent/jie-dian-kong-zhi.html">
            
                    
                    Node Control
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="moniorframework.html">
            
                <a href="moniorframework.html">
            
                    
                    Monitor Framework
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="moniorframework.html">
            
                <a href="moniorframework.html">
            
                    
                    MOF Architecture
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="moniorframework/mof-agent.html">
            
                <a href="moniorframework/mof-agent.html">
            
                    
                    MOF Agent
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="moniorframework/supportor.html">
            
                <a href="moniorframework/supportor.html">
            
                    
                    Supportor
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="moniorframework/globalfilter.html">
            
                <a href="moniorframework/globalfilter.html">
            
                    
                    GlobalFilter
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="moniorframework/interceptframework.html">
            
                <a href="moniorframework/interceptframework.html">
            
                    
                    InterceptFramework
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="moniorframework/captureframework.html">
            
                <a href="moniorframework/captureframework.html">
            
                    
                    CaptureFramework
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7" data-path="moniorframework/mofshu-ju-cai-ji.html">
            
                <a href="moniorframework/mofshu-ju-cai-ji.html">
            
                    
                    MOF Data Collection
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.7.1" data-path="moniorframework/shi-shi-shu-ju-sheng-cheng.html">
            
                <a href="moniorframework/shi-shi-shu-ju-sheng-cheng.html">
            
                    
                    Monitoring Data Collection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7.2" data-path="moniorframework/hua-xiang-shu-ju-cai-ji.html">
            
                <a href="moniorframework/hua-xiang-shu-ju-cai-ji.html">
            
                    
                    Profile Data Collection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7.3" data-path="moniorframework/diao-yong-lian-shu-ju-sheng-cheng.html">
            
                <a href="moniorframework/diao-yong-lian-shu-ju-sheng-cheng.html">
            
                    
                    Invocation Chain Data Collection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7.4" data-path="moniorframework/xian-cheng-fen-xi-shu-ju-cai-ji.html">
            
                <a href="moniorframework/xian-cheng-fen-xi-shu-ju-cai-ji.html">
            
                    
                    Thread Analysis Data Collection
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >Monitor Agent</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="monitor-agent">Monitor Agent</h1>
<h1 id="ma-architecture">MA Architecture</h1>
<h2 id="implementation-architecture-of-ma">Implementation Architecture of MA:</h2>
<p><img src="assets/ma_01.png" alt=""></p>
<p>MA is an agent for decoupling and runs independently outside applications. MA fetches MOF information periodically, detects Tomcat, MSCP and JavaEE information automatically, and obtains more derived monitoring information. Then data in MA is delivered to <a href="healthmanager">Health Manager</a> via RocketMQ.</p>
<p>Below are two approaches in which MA obtains values: </p>
<ol>
<li><a href="moniorframework.html">Monitor Framework</a> tracks J2EE projects and MA obtains data from such projects</li>
<li>MA obtains parameter values from the system</li>
</ol>
<h2 id="workflow-of-ma">Workflow of MA:</h2>
<p><img src="assets/ma_02.png" alt=""></p>
<ol>
<li>As MSCP&apos;s program entry, MSCPBoot invokes the startup method of SystemStarter when getting started.</li>
<li>SystemStarter invokes the run method of AppServerMonitorDetector in the start method of MonitorAgent when getting started.</li>
<li>Obtain all JVM processes with the run method, start the corresponding data fetching task, and determine whether the processes should get killed if they use too much CPU or memory.</li>
<li>Use the addWorker method in AppServerMonitorDetector to periodically fetch the Monitor Data of Tomcat/MSCP/JavaSE based on different values of jvmType and generate the MonitorDataFrame.</li>
<li>Detect processes if the monitoring data cannot be obtained. If the process has been killed, the related worker shall stop automatically.</li>
<li>Send MonitorDataFrame to RocketMQ. Health Manger shall process MonitorDataFrame. Messages collected are classified into <a href="ying-yong-hua-xiang-shu-ju.md">profile</a> data and <a href="ying-yong-hua-xiang-shu-ju.md">monitor</a> data, with the former being static data of the system and the latter being runtime monitoring data.</li>
</ol>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="healthmanager/jie-kou-shuo-ming.html" class="navigation navigation-prev " aria-label="Previous page: HM Interface">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="monitoragent.html" class="navigation navigation-next " aria-label="Next page: MA Architecture">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Monitor Agent","level":"1.3","depth":1,"next":{"title":"MA Architecture","level":"1.3.1","depth":2,"path":"monitoragent.md","ref":"monitoragent.md","articles":[]},"previous":{"title":"HM Interface","level":"1.2.2.10","depth":3,"path":"healthmanager/jie-kou-shuo-ming.md","ref":"healthmanager/jie-kou-shuo-ming.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"monitoragent.md","mtime":"2018-06-28T09:51:28.000Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2018-07-02T03:08:45.482Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

